webpackJsonp([1],{"++Zp":function(t,e){},Az0i:function(t,e,a){t.exports=a.p+"static/img/japan.295d29b.png"},DdVG:function(t,e){},GmTi:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),o=a("Dd8w"),s=a.n(o),i=a("NYxO"),r={name:"App",methods:s()({},Object(i.b)(["fetchAllData","fetchStepData","fetchTodayStepData","getToken"]),Object(i.d)(["setStartDate"])),created:function(){}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var u=a("VU/8")(r,c,!1,function(t){a("bwmX")},null,null).exports,l=a("/ocq"),d={name:"GoalStepCounter",computed:s()({},Object(i.c)(["remainingStep"]))},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"goal-step-counter"},[e("div",{staticClass:"counter"},[this._v(" あと"),e("span",{staticClass:"big"},[this._v(this._s(this.remainingStep))]),this._v("歩")])])},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(t){a("eFIy")},"data-v-a3a2573e",null).exports,v={name:"CanvasView",props:["img"],data:function(){return{canvas:null,ctx:null}},mounted:function(){var t=this;this.canvas=document.querySelector("#canvas"),this.canvas.width=200,this.canvas.height=200,this.ctx=this.canvas.getContext("2d");var e=new Image;e.onload=function(){t.ctx.globalCompositeOperation="source-over",t.ctx.drawImage(e,0,0,t.canvas.width,t.canvas.height)}}},g={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"canvas-view"},[e("canvas",{attrs:{id:"canvas"}})])}]};var h=a("VU/8")(v,g,!1,function(t){a("hjp4")},"data-v-7bddbe60",null).exports,f=a("Az0i"),_=a.n(f),S={name:"GoalImage",components:{CanvasView:h},data:function(){return{image:_.a}},computed:s()({},Object(i.c)(["remainingStep"])),mounted:function(){console.log("mounted"),this.drawPicture()},methods:{drawPicture:function(){var t=document.querySelector("#canvas");t.width=240,t.height=240;var e=t.getContext("2d"),a=new Image;a.src=_.a,a.onload=function(){e.globalCompositeOperation="source-over",e.drawImage(a,0,0,t.width,t.height)}}}},w={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"goal-image"},[e("canvas",{attrs:{id:"canvas"}})])}]};var C=a("VU/8")(S,w,!1,function(t){a("DdVG")},"data-v-7b2d2b3f",null).exports,b={name:"TodayStepCounter",data:function(){return{}},computed:s()({},Object(i.e)(["currentTodayStep"]))},y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"today-step-counter"},[e("div",{staticClass:"counter"},[this._v("今日の歩数:"+this._s(this.currentTodayStep)+"歩")])])},staticRenderFns:[]};var k={name:"WalkCountPage",components:{GoalStepCounter:m,GoalImage:C,TodayStepCounter:a("VU/8")(b,y,!1,function(t){a("GmTi")},null,null).exports},data:function(){return{goalStep:1e3,currentStep:500}},computed:{remainingStep:function(){return this.goalStep-this.currentStep},authUrl:function(){return"https://accounts.google.com/o/oauth2/auth?client_id=877269797920-0bi9j8uoo3vkgg7saplohvvg07khke9v.apps.googleusercontent.com&redirect_uri=http://localhost:8080&scope=https://www.googleapis.com/auth/fitness.activity.read&response_type=code&approval_prompt=force&access_type=offline"}},methods:{setGoalStep:function(t){this.goalStep=t}}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"walk-count-page"},[a("GoalStepCounter",{attrs:{remainingStep:t.remainingStep}}),t._v(" "),a("GoalImage",{attrs:{remainingStep:t.remainingStep}}),t._v(" "),a("TodayStepCounter"),t._v(" "),a("div",{staticClass:"button-section"},[a("router-link",{staticClass:"button",attrs:{to:"/goal"}},[t._v("目標設定")]),t._v(" "),a("a",{staticClass:"button",attrs:{href:t.authUrl}},[t._v("認証")])],1)],1)},staticRenderFns:[]};var T=a("VU/8")(k,D,!1,function(t){a("++Zp")},"data-v-04d9d3dc",null).exports,x={namt:"GoalSelectPage",data:function(){return{isModalOpen:!1,date:null}},computed:s()({},Object(i.e)(["startDate"]),Object(i.c)(["startDateObject"]),{displayDate:function(){var t=this.startDateObject;return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日"}}),methods:s()({},Object(i.d)(["setGoalStep"]),{onClickGoalItem:function(t){this.setGoalStep(t),this.$router.push("/");var e=new Date;this.$cookie.set("startDate",e.getTime(),356)}})},G={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"goal-select-page"},[a("div",{staticClass:"date"},[t._v("はじめた日:"+t._s(t.displayDate))]),t._v(" "),a("div",{staticClass:"goal-item lv1",on:{click:function(e){t.onClickGoalItem(35e5)}}}),t._v(" "),a("div",{staticClass:"goal-item lv2",on:{click:function(e){t.onClickGoalItem(18e6)}}}),t._v(" "),a("div",{staticClass:"goal-item lv3",on:{click:function(e){t.onClickGoalItem(55e7)}}}),t._v(" "),a("router-link",{staticClass:"button",attrs:{to:"/"}},[t._v("戻る")]),t._v(" "),this.isModalOpen?a("div",{staticClass:"modal"},[a("p",[t._v("開始日がリセットされますがよろしいですか?")]),t._v(" "),a("div",[t._v("はい")]),t._v(" "),a("div",[t._v("いいえ")])]):t._e(),t._v(" "),this.isModalOpen?a("div",{staticClass:"modal-bg"}):t._e()],1)},staticRenderFns:[]};var j=a("VU/8")(x,G,!1,function(t){a("vP5y")},"data-v-f1f52ce6",null).exports;n.a.use(l.a);var O=new l.a({routes:[{path:"/",name:"WalkCountPage",component:T},{path:"/goal",name:"GoalSelectPage",component:j}]}),I=a("Xxa5"),V=a.n(I),M=a("exGp"),F=a.n(M),$=a("mtWM"),A=a.n($),E=a("K/Lq"),P=a.n(E);n.a.use(i.a);var U=new i.a.Store({state:{goalStep:35e5,currentStep:0,currentTodayStep:0,startDate:null,token:"ya29.GlxlBbndXjGAM-naNuDw1JXJyWTSKiYFzTRaxxlUoSeYw7fG_H6WruicY7c7wrt0qdWwxuWbngOu0uNbVBwkHqoma-Dt6qs0-LtxCrw4gkl8Vk4D3xR9v7sgqdz19Q"},getters:{remainingStep:function(t){return t.goalStep-t.currentStep},startDateObject:function(t){return new Date(t.startDate)}},mutations:{setGoalStep:function(t,e){t.goalStep=e},setCurrentStep:function(t,e){t.currentStep=e},setCurrentTodayStep:function(t,e){t.currentTodayStep=e},setStartDate:function(t,e){t.startDate=Number(e)}},actions:{fetchAllData:function(t){var e=this,a=t.commit,n=t.dispatch;return F()(V.a.mark(function t(){var o;return V.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=P.a.get("startDate"),a("setStartDate",o),t.next=4,n("fetchTodayStepData");case 4:return t.next=6,n("fetchStepData");case 6:case"end":return t.stop()}},t,e)}))()},fetchTodayStepData:function(t){var e=this,a=t.commit,n=t.state;return F()(V.a.mark(function t(){var o,s,i;return V.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=new Date,s=o.getTime(),i=s-864e5,A()({method:"post",url:"https://www.googleapis.com/fitness/v1/users/me/dataset:aggregate",data:{aggregateBy:[{dataTypeName:"com.google.step_count.delta",dataSourceId:"derived:com.google.step_count.delta:com.google.android.gms:estimated_steps"}],bucketByTime:{durationMillis:864e5},startTimeMillis:i,endTimeMillis:s},headers:{"Content-Type":"application/json;encoding=utf-8",Authorization:"Bearer "+n.token}}).then(function(t){var e=t.data.bucket[0].dataset[0].point[0].value[0].intVal;a("setCurrentTodayStep",e)});case 4:case"end":return t.stop()}},t,e)}))()},fetchStepData:function(t){var e=this,a=t.commit,n=t.state;return F()(V.a.mark(function t(){var o,s,i;return V.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=new Date,s=o.getTime(),i=Number(n.startDate),A()({method:"post",url:"https://www.googleapis.com/fitness/v1/users/me/dataset:aggregate",data:{aggregateBy:[{dataTypeName:"com.google.step_count.delta",dataSourceId:"derived:com.google.step_count.delta:com.google.android.gms:estimated_steps"}],bucketByTime:{durationMillis:864e5},startTimeMillis:i,endTimeMillis:s},headers:{"Content-Type":"application/json;encoding=utf-8",Authorization:"Bearer "+n.token}}).then(function(t){var e=t.data.bucket.reduce(function(t,e){return 0===e.dataset[0].point.length?t:t+e.dataset[0].point[0].value[0].intVal},0);a("setCurrentStep",e)});case 4:case"end":return t.stop()}},t,e)}))()},getToken:function(t,e){t.commit;A()({method:"post",url:"https://accounts.google.com/v4/oauth2/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{client_id:"877269797920-0bi9j8uoo3vkgg7saplohvvg07khke9v.apps.googleusercontent.com",client_secret:"Q4brrElXPOcxo9Td1diJj2oI",redirect_url:"http://localhost:8080",grant_type:"authorization_code",code:e}}).then(function(t){console.log(t)})}}});n.a.use(P.a),n.a.config.productionTip=!1,new n.a({el:"#app",router:O,store:U,components:{App:u},template:"<App/>"})},bwmX:function(t,e){},eFIy:function(t,e){},hjp4:function(t,e){},vP5y:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.9b638848a93f1ca994fc.js.map